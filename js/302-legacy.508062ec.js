(self["webpackChunkforum_front_end_vue2"]=self["webpackChunkforum_front_end_vue2"]||[]).push([[302],{8448:function(t,e,r){"use strict";r.d(e,{Z:function(){return P}});var a,n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"nav nav-tabs mb-4"},t._l(t.tabs,(function(e){return r("li",{key:e.id,staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:e.path}},[t._v(" "+t._s(e.title)+" ")])],1)})),0)},s=[],i=new Uint8Array(16);function o(){if(!a&&(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}var u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function c(t){return"string"===typeof t&&u.test(t)}for(var l=c,d=[],p=0;p<256;++p)d.push((p+256).toString(16).substr(1));function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(d[t[e+0]]+d[t[e+1]]+d[t[e+2]]+d[t[e+3]]+"-"+d[t[e+4]]+d[t[e+5]]+"-"+d[t[e+6]]+d[t[e+7]]+"-"+d[t[e+8]]+d[t[e+9]]+"-"+d[t[e+10]]+d[t[e+11]]+d[t[e+12]]+d[t[e+13]]+d[t[e+14]]+d[t[e+15]]).toLowerCase();if(!l(r))throw TypeError("Stringified UUID is invalid");return r}var f=g;function v(t,e,r){t=t||{};var a=t.random||(t.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e){r=r||0;for(var n=0;n<16;++n)e[r+n]=a[n];return e}return f(a)}var m=v,h={data:function(){return{tabs:[{id:m(),title:"首頁",path:"/restaurants"},{id:m(),title:"最新動態",path:"/restaurants/feeds"},{id:m(),title:"TOP 10 人氣餐廳",path:"/restaurants/top"},{id:m(),title:"美食達人",path:"/users/top"}]}}},y=h,b=r(1001),k=(0,b.Z)(y,n,s,!1,null,"2ab0b204",null),P=k.exports},8410:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return A}});var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container py-5"},[r("navTabs"),t.isLoading?r("Spinner"):[r("RestaurantsNavPills",{attrs:{categories:t.categories}}),r("div",{staticClass:"row"},[t._l(t.restaurants,(function(t){return r("RestaurantCard",{key:t.id,attrs:{"initial-restaurant":t}})})),t.restaurants.length<1?r("div",[t._v("此類別無餐廳")]):t._e()],2),t.totalPage.length?r("RestaurantsPagination",{attrs:{categoryId:t.categoryId,currentPage:t.currentPage,totalPage:t.totalPage,prev:t.previousPage,next:t.nextPage}}):t._e()]],2)},n=[],s=r(6198),i=(r(5666),r(8448)),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-md-6 col-lg-4"},[r("div",{staticClass:"card mb-4"},[r("img",{staticClass:"card-img-top",attrs:{src:t.restaurant.image,alt:t.restaurant.name,width:"286px",height:"180px"}}),r("div",{staticClass:"card-body"},[r("p",{staticClass:"card-text title-wrap"},[r("router-link",{attrs:{to:{name:"RESTAURANT",params:{id:t.restaurant.id}}}},[t._v(" "+t._s(t.restaurant.name)+" ")])],1),r("span",{staticClass:"badge badge-secondary"},[t._v(" "+t._s(t.restaurant.Category.name)+" ")]),r("p",{staticClass:"card-text text-truncate"},[t._v(" "+t._s(t.restaurant.description)+" ")])]),r("div",{staticClass:"card-footer"},[t.restaurant.isFavorited?r("button",{staticClass:"btn btn-danger btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFavorited(t.restaurant.id)}}},[t._v(" 移除最愛 ")]):r("button",{staticClass:"btn btn-primary btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addFavorited(t.restaurant.id)}}},[t._v(" 加到最愛 ")]),t.restaurant.isLiked?r("button",{staticClass:"btn btn-danger like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteLike(t.restaurant.id)}}},[t._v(" Unlike ")]):r("button",{staticClass:"btn btn-primary like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addLike(t.restaurant.id)}}},[t._v(" Like ")])])])])},u=[],c=r(3019),l=(r(1703),r(3652)),d=r(1926),p={props:{initialRestaurant:{type:Object,required:!0}},data:function(){return{restaurant:this.initialRestaurant,isProcessing:!1}},methods:{addFavorited:function(t){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,l.Z.addFavorite({restaurantId:t});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:e.restaurant=(0,c.Z)((0,c.Z)({},e.restaurant),{},{isFavorited:!0}),e.isProcessing=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),e.isProcessing=!1,console.log("error",r.t0),d.F.fire({icon:"error",title:"無法取得資料，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},deleteFavorited:function(t){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,l.Z.deleteFavorite({restaurantId:t});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:e.restaurant=(0,c.Z)((0,c.Z)({},e.restaurant),{},{isFavorited:!1}),e.isProcessing=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),e.isProcessing=!1,console.log("error",r.t0),d.F.fire({icon:"error",title:"無法取得資料，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},addLike:function(t){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,l.Z.addLike({restaurantId:t});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:e.restaurant=(0,c.Z)((0,c.Z)({},e.restaurant),{},{isLiked:!0}),e.isProcessing=!1,r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](0),e.isProcessing=!1,d.F.fire({icon:"error",title:"無法取得資料，請稍後再試"});case 16:case"end":return r.stop()}}),r,null,[[0,12]])})))()},deleteLike:function(t){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,l.Z.deleteLike({restaurantId:t});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:e.restaurant=(0,c.Z)((0,c.Z)({},e.restaurant),{},{isLiked:!1}),e.isProcessing=!1,r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](0),e.isProcessing=!1,d.F.fire({icon:"error",title:"無法取得資料，請稍後再試"});case 16:case"end":return r.stop()}}),r,null,[[0,12]])})))()}}},g=p,f=r(1001),v=(0,f.Z)(g,o,u,!1,null,"7da7c861",null),m=v.exports,h=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"nav nav-pills mb-4"},[r("li",{staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"RESTAURANTS"}}},[t._v(" 全部 ")])],1),t._l(t.categories,(function(e){return r("li",{key:e.id,staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"RESTAURANTS",query:{categoryId:e.id}}}},[t._v(" "+t._s(e.name)+" ")])],1)}))],2)},y=[],b={props:{categories:{type:Array,required:!0}}},k=b,P=(0,f.Z)(k,h,y,!1,null,"4be41aa4",null),x=P.exports,R=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{attrs:{"aria-label":"Page navigation example"}},[r("ul",{staticClass:"pagination"},[r("li",{class:["page-item",{disabled:1===t.currentPage}]},[r("router-link",{staticClass:"page-link",attrs:{"aria-label":"Previous",to:{name:"RESTAURANTS",query:{categoryId:t.categoryId,page:t.prev}}}},[r("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])],1),t._l(t.totalPage,(function(e){return r("li",{key:e,class:["page-item",{active:t.currentPage===e}]},[r("router-link",{staticClass:"page-link",attrs:{to:{name:"RESTAURANTS",query:{categoryId:t.categoryId,page:e}}}},[t._v(" "+t._s(e)+" ")])],1)})),r("li",{class:["page-item",{disabled:t.currentPage===t.totalPage.length}]},[r("router-link",{staticClass:"page-link",attrs:{"aria-label":"Next",to:{name:"RESTAURANTS",query:{categoryId:t.categoryId,page:t.next}}}},[r("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])],1)],2)])},_=[],C=(r(9653),{name:"RestaurantsPagination",props:{categoryId:{type:[Number,String],default:""},currentPage:{type:Number,default:1},totalPage:{type:Array,require:!0},prev:{type:Number,require:!0},next:{type:Number,require:!0}}}),w=C,E=(0,f.Z)(w,R,_,!1,null,"32b0b58a",null),Z=E.exports,I=r(2261),S=r(1947),T={name:"restaurants",components:{navTabs:i.Z,RestaurantCard:m,RestaurantsNavPills:x,RestaurantsPagination:Z,Spinner:I.Z},data:function(){return{restaurants:[],categories:[],categoryId:-1,currentPage:1,totalPage:[],previousPage:-1,nextPage:-1,isLoading:!0}},created:function(){var t=this.$route.query,e=t.page,r=void 0===e?"":e,a=t.categoryId,n=void 0===a?"":a;this.fetchRestaurants({queryPage:r,queryCategoryId:n})},beforeRouteUpdate:function(t,e,r){var a=t.query,n=a.page,s=void 0===n?"":n,i=a.categoryId,o=void 0===i?"":i;this.fetchRestaurants({queryPage:s,queryCategoryId:o}),r()},methods:{fetchRestaurants:function(t){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function r(){var a,n,s,i,o,u,c,l,p,g,f;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t.queryPage,n=t.queryCategoryId,r.prev=1,r.next=4,S.Z.getRestaurants({page:a,categoryId:n});case 4:s=r.sent,console.log("response",s),i=s.data,o=i.restaurants,u=i.categories,c=i.categoryId,l=i.page,p=i.totalPage,g=i.prev,f=i.next,e.restaurants=o,e.categories=u,e.categoryId=c,e.currentPage=l,e.totalPage=p,e.previousPage=g,e.nextPage=f,e.isLoading=!1,r.next=21;break;case 17:r.prev=17,r.t0=r["catch"](1),e.isLoading=!1,d.F.fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"});case 21:case"end":return r.stop()}}),r,null,[[1,17]])})))()}}},q=T,L=(0,f.Z)(q,a,n,!1,null,null,null),A=L.exports},7741:function(t,e,r){var a=r(1702),n=Error,s=a("".replace),i=function(t){return String(n(t).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,u=o.test(i);t.exports=function(t,e){if(u&&"string"==typeof t&&!n.prepareStackTrace)while(e--)t=s(t,o,"");return t}},2914:function(t,e,r){var a=r(7293),n=r(9114);t.exports=!a((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)}))},8340:function(t,e,r){var a=r(111),n=r(8880);t.exports=function(t,e){a(e)&&"cause"in e&&n(t,"cause",e.cause)}},6277:function(t,e,r){var a=r(1340);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:a(t)}},2626:function(t,e,r){var a=r(3070).f;t.exports=function(t,e,r){r in t||a(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},9191:function(t,e,r){"use strict";var a=r(5005),n=r(2597),s=r(8880),i=r(7976),o=r(7674),u=r(9920),c=r(2626),l=r(9587),d=r(6277),p=r(8340),g=r(7741),f=r(2914),v=r(9781),m=r(1913);t.exports=function(t,e,r,h){var y="stackTraceLimit",b=h?2:1,k=t.split("."),P=k[k.length-1],x=a.apply(null,k);if(x){var R=x.prototype;if(!m&&n(R,"cause")&&delete R.cause,!r)return x;var _=a("Error"),C=e((function(t,e){var r=d(h?e:t,void 0),a=h?new x(t):new x;return void 0!==r&&s(a,"message",r),f&&s(a,"stack",g(a.stack,2)),this&&i(R,this)&&l(a,this,C),arguments.length>b&&p(a,arguments[b]),a}));if(C.prototype=R,"Error"!==P?o?o(C,_):u(C,_,{name:!0}):v&&y in x&&(c(C,x,y),c(C,x,"prepareStackTrace")),u(C,x),!m)try{R.name!==P&&s(R,"name",P),R.constructor=C}catch(w){}return C}}},1703:function(t,e,r){var a=r(2109),n=r(7854),s=r(2104),i=r(9191),o="WebAssembly",u=n[o],c=7!==Error("e",{cause:7}).cause,l=function(t,e){var r={};r[t]=i(t,e,c),a({global:!0,forced:c},r)},d=function(t,e){if(u&&u[t]){var r={};r[t]=i(o+"."+t,e,c),a({target:o,stat:!0,forced:c},r)}};l("Error",(function(t){return function(e){return s(t,this,arguments)}})),l("EvalError",(function(t){return function(e){return s(t,this,arguments)}})),l("RangeError",(function(t){return function(e){return s(t,this,arguments)}})),l("ReferenceError",(function(t){return function(e){return s(t,this,arguments)}})),l("SyntaxError",(function(t){return function(e){return s(t,this,arguments)}})),l("TypeError",(function(t){return function(e){return s(t,this,arguments)}})),l("URIError",(function(t){return function(e){return s(t,this,arguments)}})),d("CompileError",(function(t){return function(e){return s(t,this,arguments)}})),d("LinkError",(function(t){return function(e){return s(t,this,arguments)}})),d("RuntimeError",(function(t){return function(e){return s(t,this,arguments)}}))}}]);
//# sourceMappingURL=302-legacy.508062ec.js.map