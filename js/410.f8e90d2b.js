"use strict";(self["webpackChunkforum_front_end_vue2"]=self["webpackChunkforum_front_end_vue2"]||[]).push([[410],{8448:function(t,e,a){a.d(e,{Z:function(){return _}});var r,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"nav nav-tabs mb-4"},t._l(t.tabs,(function(e){return a("li",{key:e.id,staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:e.path}},[t._v(" "+t._s(e.title)+" ")])],1)})),0)},n=[],i=new Uint8Array(16);function o(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function c(t){return"string"===typeof t&&u.test(t)}for(var l=c,d=[],g=0;g<256;++g)d.push((g+256).toString(16).substr(1));function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(d[t[e+0]]+d[t[e+1]]+d[t[e+2]]+d[t[e+3]]+"-"+d[t[e+4]]+d[t[e+5]]+"-"+d[t[e+6]]+d[t[e+7]]+"-"+d[t[e+8]]+d[t[e+9]]+"-"+d[t[e+10]]+d[t[e+11]]+d[t[e+12]]+d[t[e+13]]+d[t[e+14]]+d[t[e+15]]).toLowerCase();if(!l(a))throw TypeError("Stringified UUID is invalid");return a}var v=p;function f(t,e,a){t=t||{};var r=t.random||(t.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){a=a||0;for(var s=0;s<16;++s)e[a+s]=r[s];return e}return v(r)}var y=f,m={data(){return{tabs:[{id:y(),title:"首頁",path:"/restaurants"},{id:y(),title:"最新動態",path:"/restaurants/feeds"},{id:y(),title:"TOP 10 人氣餐廳",path:"/restaurants/top"},{id:y(),title:"美食達人",path:"/users/top"}]}}},h=m,b=a(1001),P=(0,b.Z)(h,s,n,!1,null,"2ab0b204",null),_=P.exports},2261:function(t,e,a){a.d(e,{Z:function(){return u}});var r=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spinner"},[a("div",{staticClass:"bouncing-loader"},[a("div"),a("div"),a("div")])])}],n=a(1001),i={},o=(0,n.Z)(i,r,s,!1,null,"74807b6a",null),u=o.exports},8410:function(t,e,a){a.r(e),a.d(e,{default:function(){return T}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container py-5"},[a("navTabs"),t.isLoading?a("Spinner"):[a("RestaurantsNavPills",{attrs:{categories:t.categories}}),a("div",{staticClass:"row"},[t._l(t.restaurants,(function(t){return a("RestaurantCard",{key:t.id,attrs:{"initial-restaurant":t}})})),t.restaurants.length<1?a("div",[t._v("此類別無餐廳")]):t._e()],2),t.totalPage.length?a("RestaurantsPagination",{attrs:{categoryId:t.categoryId,currentPage:t.currentPage,totalPage:t.totalPage,prev:t.previousPage,next:t.nextPage}}):t._e()]],2)},s=[],n=a(8448),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6 col-lg-4"},[a("div",{staticClass:"card mb-4"},[a("img",{staticClass:"card-img-top",attrs:{src:t.restaurant.image,alt:t.restaurant.name,width:"286px",height:"180px"}}),a("div",{staticClass:"card-body"},[a("p",{staticClass:"card-text title-wrap"},[a("router-link",{attrs:{to:{name:"RESTAURANT",params:{id:t.restaurant.id}}}},[t._v(" "+t._s(t.restaurant.name)+" ")])],1),a("span",{staticClass:"badge badge-secondary"},[t._v(" "+t._s(t.restaurant.Category.name)+" ")]),a("p",{staticClass:"card-text text-truncate"},[t._v(" "+t._s(t.restaurant.description)+" ")])]),a("div",{staticClass:"card-footer"},[t.restaurant.isFavorited?a("button",{staticClass:"btn btn-danger btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFavorited(t.restaurant.id)}}},[t._v(" 移除最愛 ")]):a("button",{staticClass:"btn btn-primary btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addFavorited(t.restaurant.id)}}},[t._v(" 加到最愛 ")]),t.restaurant.isLiked?a("button",{staticClass:"btn btn-danger like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteLike(t.restaurant.id)}}},[t._v(" Unlike ")]):a("button",{staticClass:"btn btn-primary like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addLike(t.restaurant.id)}}},[t._v(" Like ")])])])])},o=[],u=(a(1703),a(3652)),c=a(1926),l={props:{initialRestaurant:{type:Object,required:!0}},data(){return{restaurant:this.initialRestaurant,isProcessing:!1}},methods:{async addFavorited(t){try{this.isProcessing=!0;const{data:e}=await u.Z.addFavorite({restaurantId:t});if("success"!==e.status)throw new Error(e.message);this.restaurant={...this.restaurant,isFavorited:!0},this.isProcessing=!1}catch(e){this.isProcessing=!1,console.log("error",e),c.F.fire({icon:"error",title:"無法取得資料，請稍後再試"})}},async deleteFavorited(t){try{this.isProcessing=!0;const{data:e}=await u.Z.deleteFavorite({restaurantId:t});if("success"!==e.status)throw new Error(e.message);this.restaurant={...this.restaurant,isFavorited:!1},this.isProcessing=!1}catch(e){this.isProcessing=!1,console.log("error",e),c.F.fire({icon:"error",title:"無法取得資料，請稍後再試"})}},async addLike(t){try{this.isProcessing=!0;const{data:e}=await u.Z.addLike({restaurantId:t});if("success"!==e.status)throw new Error(e.message);this.restaurant={...this.restaurant,isLiked:!0},this.isProcessing=!1}catch(e){this.isProcessing=!1,c.F.fire({icon:"error",title:"無法取得資料，請稍後再試"})}},async deleteLike(t){try{this.isProcessing=!0;const{data:e}=await u.Z.deleteLike({restaurantId:t});if("success"!==e.status)throw new Error(e.message);this.restaurant={...this.restaurant,isLiked:!1},this.isProcessing=!1}catch(e){this.isProcessing=!1,c.F.fire({icon:"error",title:"無法取得資料，請稍後再試"})}}}},d=l,g=a(1001),p=(0,g.Z)(d,i,o,!1,null,"7da7c861",null),v=p.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"nav nav-pills mb-4"},[a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"RESTAURANTS"}}},[t._v(" 全部 ")])],1),t._l(t.categories,(function(e){return a("li",{key:e.id,staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"RESTAURANTS",query:{categoryId:e.id}}}},[t._v(" "+t._s(e.name)+" ")])],1)}))],2)},y=[],m={props:{categories:{type:Array,required:!0}}},h=m,b=(0,g.Z)(h,f,y,!1,null,"4be41aa4",null),P=b.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{attrs:{"aria-label":"Page navigation example"}},[a("ul",{staticClass:"pagination"},[a("li",{class:["page-item",{disabled:1===t.currentPage}]},[a("router-link",{staticClass:"page-link",attrs:{"aria-label":"Previous",to:{name:"RESTAURANTS",query:{categoryId:t.categoryId,page:t.prev}}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])],1),t._l(t.totalPage,(function(e){return a("li",{key:e,class:["page-item",{active:t.currentPage===e}]},[a("router-link",{staticClass:"page-link",attrs:{to:{name:"RESTAURANTS",query:{categoryId:t.categoryId,page:e}}}},[t._v(" "+t._s(e)+" ")])],1)})),a("li",{class:["page-item",{disabled:t.currentPage===t.totalPage.length}]},[a("router-link",{staticClass:"page-link",attrs:{"aria-label":"Next",to:{name:"RESTAURANTS",query:{categoryId:t.categoryId,page:t.next}}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])],1)],2)])},C=[],k={name:"RestaurantsPagination",props:{categoryId:{type:[Number,String],default:""},currentPage:{type:Number,default:1},totalPage:{type:Array,require:!0},prev:{type:Number,require:!0},next:{type:Number,require:!0}}},R=k,I=(0,g.Z)(R,_,C,!1,null,"32b0b58a",null),w=I.exports,x=a(2261),E=a(1947),S={name:"restaurants",components:{navTabs:n.Z,RestaurantCard:v,RestaurantsNavPills:P,RestaurantsPagination:w,Spinner:x.Z},data(){return{restaurants:[],categories:[],categoryId:-1,currentPage:1,totalPage:[],previousPage:-1,nextPage:-1,isLoading:!0}},created(){const{page:t="",categoryId:e=""}=this.$route.query;this.fetchRestaurants({queryPage:t,queryCategoryId:e})},beforeRouteUpdate(t,e,a){const{page:r="",categoryId:s=""}=t.query;this.fetchRestaurants({queryPage:r,queryCategoryId:s}),a()},methods:{async fetchRestaurants({queryPage:t,queryCategoryId:e}){try{const a=await E.Z.getRestaurants({page:t,categoryId:e});console.log("response",a);const{restaurants:r,categories:s,categoryId:n,page:i,totalPage:o,prev:u,next:c}=a.data;this.restaurants=r,this.categories=s,this.categoryId=n,this.currentPage=i,this.totalPage=o,this.previousPage=u,this.nextPage=c,this.isLoading=!1}catch(a){this.isLoading=!1,c.F.fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"})}}}},q=S,L=(0,g.Z)(q,r,s,!1,null,null,null),T=L.exports},1947:function(t,e,a){var r=a(1926);e["Z"]={getRestaurants({page:t,categoryId:e}){const a=new URLSearchParams({page:t,categoryId:e});return r.l.get(`/restaurants?${a.toString()}`)},getFeeds(){return r.l.get("/restaurants/feeds")},restaurants:{create({formData:t}){return r.l.post("/admin/restaurants",t)},getRestaurant({restaurantId:t}){return r.l.get(`/restaurants/${t}`)}},comments:{postComments({restaurantId:t,text:e}){return r.l.post("/comments",{restaurantId:t,text:e})},deleteComment({id:t}){return r.l["delete"](`/comments/${t}`)}}}}}]);
//# sourceMappingURL=410.f8e90d2b.js.map